# 带认证的代理插件

中文文档 | [English](./README.md)

一个轻量级的 Chrome 浏览器扩展，支持带用户名和密码认证的 HTTP/HTTPS 代理。非常适合需要通过需要认证的代理服务器访问网络的开发者和用户。

## ✨ 功能特性

- 🔐 **认证支持**：完整支持需要用户名和密码的代理服务器
- 🔄 **协议切换**：支持 HTTP 和 HTTPS 代理协议切换
- 💾 **自动持久化**：浏览器重启后自动保存和恢复代理设置
- 🧪 **代理测试**：内置代理连接测试功能，验证 IP 地址
- 🚀 **快速切换**：一键启用/禁用代理
- 🎯 **轻量级**：资源占用极小，不影响浏览器性能
- 🔒 **安全存储**：使用 Chrome 安全存储 API 保存凭据

## 📦 安装方法

### 从源码安装

1. 下载或克隆此仓库
2. 打开 Chrome 浏览器，访问 `chrome://extensions/`
3. 在右上角启用"开发者模式"
4. 点击"加载已解压的扩展程序"，选择插件文件夹
5. 代理插件图标将出现在浏览器工具栏中

## 🚀 快速开始

### 1. 配置代理

1. 点击工具栏中的插件图标
2. 选择协议：**HTTP** 或 **HTTPS**
3. 输入代理配置，格式：`ip:port:username:password`
   - 示例：`192.168.42.118:5907:myuser:mypass`
4. 点击 **"保存配置"** 按钮

### 2. 测试代理（可选）

1. 点击 **"测试代理"** 按钮
2. 等待测试完成
3. 查看测试结果：
   - ✅ 成功：显示代理的 IP 地址
   - ❌ 失败：检查配置是否正确

### 3. 启用代理

1. 点击 **"启用代理"** 按钮
2. 状态将变为"代理已启用 (HTTP/HTTPS)"
3. 所有浏览器流量现在将通过代理路由

### 4. 禁用代理

1. 点击 **"禁用代理"** 按钮
2. 浏览器恢复直连

## 📖 使用指南

### 配置格式

```
ip:port:username:password
```

- **ip**：代理服务器 IP 地址
- **port**：代理服务器端口号
- **username**：认证用户名
- **password**：认证密码

### 协议选择

- **HTTP**：标准 HTTP 代理（最常用）
- **HTTPS**：安全 HTTPS 代理（加密连接）

### 状态指示

- 🔴 **代理未启用**：直接连接，不使用代理
- 🟢 **代理已启用 (HTTP)**：流量通过 HTTP 代理路由
- 🟢 **代理已启用 (HTTPS)**：流量通过 HTTPS 代理路由

### 测试结果

- 🔵 **测试中**：正在连接代理服务器...
- ✅ **成功**：连接成功，显示代理 IP
- ❌ **失败**：连接失败，请检查设置

## 🔧 技术细节

### 架构设计

```
┌─────────────┐
│  popup.html │  ← 用户界面
│  popup.js   │
└──────┬──────┘
       │
       ↓
┌─────────────────┐
│  background.js  │  ← 后台服务
│                 │     - 管理认证凭据
│                 │     - 处理认证请求
└─────────────────┘
       │
       ↓
┌─────────────────┐
│ Chrome 代理 API │  ← 系统级别
│   + 存储 API    │
└─────────────────┘
```

### 权限说明

- `proxy`：配置浏览器代理设置
- `storage`：存储配置和凭据
- `webRequest`：拦截认证请求
- `webRequestAuthProvider`：提供认证凭据
- `<all_urls>`：处理所有 URL 的请求

### 自动恢复

插件会自动从以下情况恢复：
- ✅ 浏览器重启
- ✅ 插件重新加载
- ✅ 网络断开/重连
- ✅ 电脑休眠/唤醒

## 🛡️ 安全性

- 凭据使用 Chrome 的 `chrome.storage.sync` API 存储
- 数据加密并可跨设备同步（如果启用了 Chrome 同步）
- 不向任何外部服务器发送数据
- 认证仅通过 Chrome 原生机制进行

## 🐛 常见问题

### 代理一直弹出登录框

- 确保在启用前点击了"保存配置"
- 检查用户名和密码是否正确
- 尝试禁用后重新启用代理

### 测试失败但手动浏览正常

- 某些代理服务器可能阻止测试 API（`api.ipify.org`）
- 如果正常浏览可以工作，说明代理功能正常

### 浏览器重启后代理不工作

- 从 `chrome://extensions/` 重新加载插件
- 这是 Chrome 插件系统的偶发问题

### 连接速度慢

- 这通常与代理服务器性能有关
- 尝试在 HTTP 和 HTTPS 协议之间切换
- 联系代理服务提供商

## 📝 开发说明

### 文件结构

```
my-proxy-extension/
├── manifest.json       # 插件清单文件
├── background.js       # 后台服务脚本
├── popup.html         # 插件弹窗界面
├── popup.js           # 弹窗逻辑
├── icon.png           # 插件图标
└── README.md          # 文档
```

### 使用的主要 API

- `chrome.proxy`：代理配置
- `chrome.storage.sync`：持久化存储
- `chrome.webRequest.onAuthRequired`：认证处理
- `chrome.runtime.onMessage`：内部消息传递

## 📄 开源协议

MIT License - 欢迎自由使用和修改

## 🤝 贡献

欢迎提交 Issue 和 Pull Request！

## 📧 技术支持

如果您遇到任何问题或有建议，请在 GitHub 上提交 Issue。

---

用 ❤️ 为需要代理认证的开发者打造

